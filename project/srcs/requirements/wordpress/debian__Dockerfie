# Ce fichier Dockerfile est destiné à la création d'une image pour un conteneur wordpress


# Utilisation de l'image de base "debian" avec la version "buster"
FROM	debian:buster

EXPOSE	9000

# Demander au gestionnaire de fichiers apk de mettre à jour sa liste de dépôts --> apk update
# Installer php7 et tous ces outils nécessaires, worDocker Dumb-Init sans mettre 
# les sources en cache --> apk add --no-cache ngi
# Mettre à jour les paquets obsolètes dans notre environnement --> apk upgrade
RUN 	apt-get update && apt-get install -y wget dumb-init \
	curl php-cli php-fpm php-mysql \
	mariadb-client \
	&& chmod +x /usr/bin/dumb-init \
	&& mkdir /var/www/ && mkdir /run/php \
	&& sed -i 's/listen = \/run\/php\/php7.3-fpm.sock/listen = 0.0.0.0:9000/g' /etc/php/7.3/fpm/pool.d/www.conf \
	&& cd /var/www/ && touch index.php \
	&& echo '<?php echo"bien joue!!; ?>' > index.php
	#&& wget https://fr.wordpress.org/wordpress-6.0-fr_FR.tar.gz -P /var/www \
	#&& cd /var/www && tar -xzf wordpress-6.0-fr_FR.tar.gz && rm \
	#&& cp -rf wordpress/* . && rm -rf wordpress latest.zip \
	#&& chown -R root:root /var/www/

VOLUME	["/var/www"]

# Définir dumb-init comme point d'entrée
#ENTRYPOINT ["/usr/bin/dumb-init", "--"]

# Éxecuter la configuration installé
CMD ["/usr/sbin/php-fpm7.3", "-F"]
